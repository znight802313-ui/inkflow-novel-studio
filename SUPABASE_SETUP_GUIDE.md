# InkFlow è´¦å·ç³»ç»Ÿä¸äº‘ç«¯åŒæ­¥å®æ–½æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ä¸º InkFlow å°è¯´åˆ›ä½œæ™ºèƒ½ä½“æ·»åŠ è´¦å·ç³»ç»Ÿå’Œäº‘ç«¯åŒæ­¥åŠŸèƒ½ã€‚å®æ–½å®Œæˆå,ç”¨æˆ·å¯ä»¥:
- âœ… æ³¨å†Œè´¦å·å¹¶ç™»å½•
- âœ… åˆ›å»ºå’Œç®¡ç†å¤šä¸ªå°è¯´é¡¹ç›®
- âœ… æ•°æ®è‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯
- âœ… è·¨è®¾å¤‡è®¿é—®å’Œç¼–è¾‘
- âœ… ä¿ç•™æœ¬åœ°å­˜å‚¨,æ”¯æŒç¦»çº¿ç¼–è¾‘

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥:åˆ›å»º Supabase é¡¹ç›®

1. è®¿é—® [https://supabase.com](https://supabase.com) å¹¶æ³¨å†Œ/ç™»å½•
2. ç‚¹å‡» "New Project" åˆ›å»ºæ–°é¡¹ç›®
3. å¡«å†™é¡¹ç›®ä¿¡æ¯:
   - Name: `inkflow` (æˆ–ä»»æ„åç§°)
   - Database Password: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç (è¯·å¦¥å–„ä¿å­˜)
   - Region: é€‰æ‹©ç¦»ä½ æœ€è¿‘çš„åŒºåŸŸ(å¦‚ Singapore æˆ– Tokyo)
4. ç­‰å¾…é¡¹ç›®åˆ›å»ºå®Œæˆ(çº¦ 2 åˆ†é’Ÿ)

### ç¬¬äºŒæ­¥:é…ç½®æ•°æ®åº“

1. åœ¨ Supabase Dashboard å·¦ä¾§èœå•,ç‚¹å‡» "SQL Editor"
2. ç‚¹å‡» "New query"
3. å¤åˆ¶ `supabase-setup.sql` æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹
4. ç²˜è´´åˆ° SQL Editor ä¸­
5. ç‚¹å‡» "Run" æ‰§è¡Œè„šæœ¬
6. ç¡®è®¤æ‰€æœ‰è¯­å¥éƒ½æˆåŠŸæ‰§è¡Œ(åº”è¯¥çœ‹åˆ°ç»¿è‰²çš„æˆåŠŸæç¤º)

### ç¬¬ä¸‰æ­¥:å¯ç”¨é‚®ç®±è®¤è¯

1. åœ¨ Supabase Dashboard å·¦ä¾§èœå•,ç‚¹å‡» "Authentication"
2. ç‚¹å‡» "Providers" æ ‡ç­¾
3. æ‰¾åˆ° "Email" provider,ç¡®ä¿å®ƒæ˜¯å¯ç”¨çŠ¶æ€(é»˜è®¤å·²å¯ç”¨)
4. (å¯é€‰)åœ¨ "Email Templates" ä¸­è‡ªå®šä¹‰æ³¨å†Œç¡®è®¤é‚®ä»¶æ¨¡æ¿

### ç¬¬å››æ­¥:è·å– API å¯†é’¥

1. åœ¨ Supabase Dashboard å·¦ä¾§èœå•,ç‚¹å‡» "Settings" (é½¿è½®å›¾æ ‡)
2. ç‚¹å‡» "API"
3. æ‰¾åˆ°ä»¥ä¸‹ä¸¤ä¸ªå€¼:
   - **Project URL**: ç±»ä¼¼ `https://xxxxx.supabase.co`
   - **anon public**: ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²(ä»¥ `eyJ` å¼€å¤´)

### ç¬¬äº”æ­¥:é…ç½®ç¯å¢ƒå˜é‡

1. æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•çš„ `.env.local` æ–‡ä»¶
2. æ‰¾åˆ° Supabase é…ç½®éƒ¨åˆ†,å¡«å…¥ä½ çš„å€¼:
   ```env
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=your-anon-key-here
   ```
3. ä¿å­˜æ–‡ä»¶

### ç¬¬å…­æ­¥:é‡å¯å¼€å‘æœåŠ¡å™¨

```bash
# åœæ­¢å½“å‰è¿è¡Œçš„æœåŠ¡å™¨ (Ctrl+C)
# ç„¶åé‡æ–°å¯åŠ¨
npm run dev
```

## âœ… éªŒè¯å®‰è£…

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3002`
2. ä½ åº”è¯¥çœ‹åˆ°ç™»å½•ç•Œé¢
3. å°è¯•æ³¨å†Œä¸€ä¸ªæ–°è´¦å·:
   - è¾“å…¥é‚®ç®±å’Œå¯†ç (è‡³å°‘ 6 ä½)
   - ç‚¹å‡»"æ³¨å†Œè´¦å·"
   - æ³¨å†ŒæˆåŠŸåä¼šæç¤ºä½ ç™»å½•
4. ä½¿ç”¨åˆšæ³¨å†Œçš„è´¦å·ç™»å½•
5. ç™»å½•æˆåŠŸååº”è¯¥çœ‹åˆ°ç†Ÿæ‚‰çš„ InkFlow ä¸»ç•Œé¢

## ğŸ“ å·²å®Œæˆçš„æ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶å·²ç»åˆ›å»ºå¹¶é…ç½®å¥½:

### æ ¸å¿ƒé…ç½®
- âœ… `lib/supabase.ts` - Supabase å®¢æˆ·ç«¯é…ç½®
- âœ… `types/database.ts` - æ•°æ®åº“ç±»å‹å®šä¹‰
- âœ… `contexts/AuthContext.tsx` - è®¤è¯ä¸Šä¸‹æ–‡
- âœ… `components/Auth/LoginForm.tsx` - ç™»å½•/æ³¨å†Œç•Œé¢
- âœ… `supabase-setup.sql` - æ•°æ®åº“å»ºè¡¨è„šæœ¬

### ä¾èµ–åŒ…
- âœ… `@supabase/supabase-js` - å·²å®‰è£…

## ğŸ”„ ä¸‹ä¸€æ­¥:å®ç°é¡¹ç›®ç®¡ç†å’ŒåŒæ­¥

å½“å‰å·²å®Œæˆ **Phase 1 å’Œ Phase 2**(Supabase é…ç½®å’Œè®¤è¯ç³»ç»Ÿ)ã€‚

æ¥ä¸‹æ¥éœ€è¦å®ç°:

### Phase 3: é¡¹ç›®ç®¡ç†ç³»ç»Ÿ
- åˆ›å»º `services/projectService.ts` - é¡¹ç›® CRUD æ“ä½œ
- åˆ›å»º `components/ProjectSelector.tsx` - é¡¹ç›®é€‰æ‹©å™¨
- ä¿®æ”¹ `Sidebar.tsx` - æ·»åŠ é¡¹ç›®åˆ‡æ¢åŠŸèƒ½

### Phase 4: æ•°æ®åŒæ­¥æœºåˆ¶
- åˆ›å»º `services/syncService.ts` - äº‘ç«¯åŒæ­¥é€»è¾‘
- å®ç°è‡ªåŠ¨åŒæ­¥å’Œå†²çªå¤„ç†
- å®ç°ç°æœ‰æ•°æ®è¿ç§»åŠŸèƒ½

### Phase 5: UI å¢å¼º
- æ·»åŠ åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨
- é¡¹ç›®ç®¡ç†ç•Œé¢
- è®¾ç½®é¡µé¢å¢å¼º(è´¦å·ç®¡ç†ã€ç™»å‡ºç­‰)

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1: çœ‹ä¸åˆ°ç™»å½•ç•Œé¢
**åŸå› **: ç¯å¢ƒå˜é‡æœªæ­£ç¡®é…ç½®
**è§£å†³**:
1. æ£€æŸ¥ `.env.local` æ–‡ä»¶ä¸­çš„ `VITE_SUPABASE_URL` å’Œ `VITE_SUPABASE_ANON_KEY` æ˜¯å¦æ­£ç¡®å¡«å†™
2. ç¡®ä¿é‡å¯äº†å¼€å‘æœåŠ¡å™¨
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶åˆ·æ–°é¡µé¢

### é—®é¢˜ 2: æ³¨å†Œæ—¶æç¤º"Supabase not configured"
**åŸå› **: Supabase é…ç½®æœªç”Ÿæ•ˆ
**è§£å†³**:
1. ç¡®è®¤ `.env.local` æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•
2. ç¡®è®¤ç¯å¢ƒå˜é‡åç§°æ­£ç¡®(å¿…é¡»ä»¥ `VITE_` å¼€å¤´)
3. é‡å¯å¼€å‘æœåŠ¡å™¨

### é—®é¢˜ 3: æ³¨å†ŒæˆåŠŸä½†æ— æ³•ç™»å½•
**åŸå› **: å¯èƒ½æ˜¯é‚®ç®±ç¡®è®¤è®¾ç½®é—®é¢˜
**è§£å†³**:
1. åœ¨ Supabase Dashboard -> Authentication -> Settings
2. æ‰¾åˆ° "Email Confirmations"
3. å…³é—­ "Enable email confirmations"(å¼€å‘é˜¶æ®µ)
4. é‡æ–°æ³¨å†Œè´¦å·

### é—®é¢˜ 4: æ•°æ®åº“æ“ä½œå¤±è´¥
**åŸå› **: RLS ç­–ç•¥æœªæ­£ç¡®é…ç½®
**è§£å†³**:
1. é‡æ–°æ‰§è¡Œ `supabase-setup.sql` è„šæœ¬
2. åœ¨ Supabase Dashboard -> Database -> Policies æ£€æŸ¥ç­–ç•¥æ˜¯å¦å­˜åœ¨
3. ç¡®è®¤æ‰€æœ‰è¡¨éƒ½å¯ç”¨äº† RLS

## ğŸ“Š æ•°æ®åº“ç»“æ„

### projects è¡¨
å­˜å‚¨ç”¨æˆ·çš„å°è¯´é¡¹ç›®åˆ—è¡¨
- `id`: é¡¹ç›®å”¯ä¸€æ ‡è¯†
- `user_id`: æ‰€å±ç”¨æˆ·
- `title`: é¡¹ç›®æ ‡é¢˜
- `is_active`: æ˜¯å¦ä¸ºå½“å‰æ´»åŠ¨é¡¹ç›®
- `metadata`: é¡¹ç›®å…ƒæ•°æ®(ç« èŠ‚æ•°ã€å­—æ•°ç­‰)

### novel_settings è¡¨
å­˜å‚¨æ¯ä¸ªé¡¹ç›®çš„å°è¯´è®¾å®š
- `project_id`: å…³è”çš„é¡¹ç›®
- `title`, `style`, `tags`: åŸºæœ¬ä¿¡æ¯
- `characters`: è§’è‰²åˆ—è¡¨(JSONB)
- `cover_image`: å°é¢å›¾ç‰‡(Base64)

### chapters è¡¨
å­˜å‚¨ç« èŠ‚å†…å®¹
- `project_id`: å…³è”çš„é¡¹ç›®
- `number`: ç« èŠ‚åºå·
- `title`, `content`: ç« èŠ‚æ ‡é¢˜å’Œå†…å®¹
- `summary`: ç« èŠ‚æ‘˜è¦

## ğŸ” å®‰å…¨æ€§

- âœ… æ‰€æœ‰å¯†ç é€šè¿‡ Supabase Auth åŠ å¯†å­˜å‚¨
- âœ… Row Level Security (RLS) ç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- âœ… API å¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†,ä¸ä¼šæäº¤åˆ°ä»£ç ä»“åº“
- âœ… æ‰€æœ‰æ•°æ®åº“æ“ä½œéƒ½ç»è¿‡èº«ä»½éªŒè¯

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å¼€å‘ç¯å¢ƒ**: å½“å‰é…ç½®é€‚ç”¨äºå¼€å‘ç¯å¢ƒã€‚ç”Ÿäº§ç¯å¢ƒéœ€è¦é¢å¤–é…ç½®(å¦‚è‡ªå®šä¹‰åŸŸåã€é‚®ä»¶æœåŠ¡ç­‰)
2. **æ•°æ®è¿ç§»**: ç°æœ‰çš„ localStorage æ•°æ®ä¼šåœ¨é¦–æ¬¡ç™»å½•åæç¤ºå¯¼å…¥
3. **ç¦»çº¿æ¨¡å¼**: æœªç™»å½•æˆ– Supabase æœªé…ç½®æ—¶,åº”ç”¨ä»å¯ä½¿ç”¨æœ¬åœ°å­˜å‚¨æ¨¡å¼
4. **å…è´¹é¢åº¦**: Supabase å…è´¹è®¡åˆ’æä¾›:
   - 500MB æ•°æ®åº“å­˜å‚¨
   - 1GB æ–‡ä»¶å­˜å‚¨
   - 50,000 æœˆæ´»è·ƒç”¨æˆ·
   - å¯¹äºä¸ªäººé¡¹ç›®å®Œå…¨å¤Ÿç”¨

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… å®Œæˆ Supabase é…ç½®å’Œæµ‹è¯•
2. â³ å®ç°é¡¹ç›®ç®¡ç†åŠŸèƒ½
3. â³ å®ç°æ•°æ®åŒæ­¥æœºåˆ¶
4. â³ æ·»åŠ  UI å¢å¼ºåŠŸèƒ½
5. â³ æµ‹è¯•å¤šè®¾å¤‡åŒæ­¥

## ğŸ’¡ æç¤º

- å»ºè®®å…ˆåœ¨å¼€å‘ç¯å¢ƒå®Œæ•´æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- å®šæœŸå¤‡ä»½ Supabase æ•°æ®åº“(Dashboard -> Database -> Backups)
- ç›‘æ§ Supabase ä½¿ç”¨é‡(Dashboard -> Settings -> Usage)

---

å¦‚æœ‰é—®é¢˜,è¯·å‚è€ƒ:
- [Supabase å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs)
- [Supabase Auth æŒ‡å—](https://supabase.com/docs/guides/auth)
- [Row Level Security æ•™ç¨‹](https://supabase.com/docs/guides/auth/row-level-security)
